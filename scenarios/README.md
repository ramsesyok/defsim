# 防衛シミュレーションシナリオファイル

このフォルダには、defsim防衛シミュレーション用のYAMLシナリオファイルが含まれています。

## シナリオファイル一覧

### 1. scenario_plane.yaml
**基本的な平面シナリオテンプレート**
- 用途: 基本機能の確認、設定ファイルのサンプル
- 敵グループ: 2グループ（計20機）
- 友軍: センサー2基、ランチャー2基
- シミュレーション時間: 15分
- 特徴: design.mdの仕様例をそのまま実装

### 2. scenario_multi_wave.yaml
**多波攻撃シナリオ**
- 用途: 複雑な戦術シナリオ、防衛システムの限界テスト
- 敵グループ: 7グループ（計92機）
- 友軍: センサー4基、ランチャー6基
- シミュレーション時間: 20分
- 特徴: 時間差攻撃、多方向攻撃、飽和攻撃の検証

### 3. scenario_simple_test.yaml
**シンプルテストシナリオ**
- 用途: 開発・デバッグ用、基本動作確認
- 敵グループ: 1グループ（4機）
- 友軍: センサー1基、ランチャー1基
- シミュレーション時間: 5分
- 特徴: 最小構成、短時間、デバッグ用ログ向け

### 4. scenario_performance_test.yaml
**性能評価シナリオ**
- 用途: 大量エージェント性能測定、スケーラビリティテスト
- 敵グループ: 10グループ（計236機）
- 友軍: センサー10基、ランチャー20基
- シミュレーション時間: 10分
- 特徴: 最大エンティティ数でのCPU/メモリ負荷測定

### 5. scenario_validation_test.yaml
**検証テストシナリオ**
- 用途: パラメータ境界値テスト、異常値処理確認
- 敵グループ: 6グループ（計67機、様々な特性）
- 友軍: センサー3基、ランチャー3基
- シミュレーション時間: 3分
- 特徴: 極端なパラメータ設定、エッジケーステスト

## シナリオファイル仕様

### 基本構造
```yaml
meta:           # メタデータ
sim:            # シミュレーション設定
world:          # 世界設定
command_post:   # 指揮所設定
policy:         # 戦術ポリシー
friendly_forces: # 友軍配置
enemy_forces:   # 敵軍配置
missile_defaults: # ミサイルデフォルト設定
```

### 座標系
- 単位: メートル (m)、秒 (s)、度 (deg)
- XY平面: +X=右、+Y=上
- Z軸: +Z=上空（高度）
- 原点: シミュレーション領域の中心
- シミュレーション領域: ±1,000,000m 四方
- 高度範囲: 0-5,000m

### 敵軍配置パターン
- **リング配置**: 中心から同心円状に配置
- **角度オフセット**: 外側リングの半角ずらし配置
- **編隊サイズ**: count パラメータで指定
- **配置間隔**: ring_spacing_m で制御

### タイミング設定
- **spawn_time_s**: 敵グループの出現時刻
- **dt_s**: シミュレーション時間刻み
- **t_max_s**: 最大シミュレーション時間
- **cooldown_s**: ランチャーのクールダウン時間

## 使用方法

### 1. シナリオの選択
目的に応じて適切なシナリオファイルを選択：
- 基本テスト: `scenario_simple_test.yaml`
- 戦術評価: `scenario_multi_wave.yaml`
- 性能測定: `scenario_performance_test.yaml`
- 境界値テスト: `scenario_validation_test.yaml`

### 2. パラメータのカスタマイズ
必要に応じてYAMLファイルのパラメータを変更：
- 敵の数や配置
- 友軍の配置や装備
- ミサイル性能
- シミュレーション時間

### 3. 実行とログ解析
- シミュレーション実行
- 結果ログの分析
- 性能メトリクスの評価

## パフォーマンス指標

### 計算量の目安
| シナリオ | 敵数 | ランチャー数 | 予想ミサイル数 | 計算複雑度 |
|---------|------|-------------|-------------|-----------|
| simple_test | 4 | 1 | ~4 | 低 |
| plane | 20 | 2 | ~8 | 中 |
| multi_wave | 92 | 6 | ~48 | 高 |
| performance_test | 236 | 20 | ~124 | 超高 |

### 推奨実行環境
- **simple/plane**: 任意の環境
- **multi_wave**: 中程度のCPU
- **performance_test**: 高性能CPU、8GB+ RAM推奨

## カスタムシナリオの作成

新しいシナリオを作成する場合は、既存のファイルをテンプレートとして使用し、以下の点に注意：

1. **座標の妥当性**: シミュレーション領域内に配置
2. **時間の整合性**: スポーン時刻 < 最大シミュレーション時間
3. **バランス**: 敵数とランチャー数の適切な比率
4. **パフォーマンス**: エンティティ数に応じた実行時間の考慮

## トラブルシューティング

### よくある問題
1. **YAML構文エラー**: インデントやコロンの位置を確認
2. **座標範囲外**: 境界値 ±1,000,000m を超えていないか確認
3. **性能問題**: エンティティ数を減らして段階的にテスト
4. **時間設定**: spawn_time_s が t_max_s を超えていないか確認